import{c}from"./notification.DyHDLNjw.js";import{B as l}from"./endpoints.QH1VciTq.js";import{k as a}from"./index.B9b1t7QR.js";import{a as d}from"./index.CViUNx8d.js";const i=`${l}/api/products`,s=d([]),n=d([]),p=async()=>{try{const e=await a.get(i,{credentials:"include"}).json();s.set(e)}catch(e){e.response&&(e.response.status===401||e.response.status===403)&&location.replace("/login"),console.log(e)}},u=async e=>{try{const o=await a.post(i,{json:e,credentials:"include"}).json();s.set(s.get().concat(o)),n.set(n.get().concat(o)),c({title:"Producto creado!",type:"success"})}catch(o){console.log(o);const t=await o.response.json();c({title:"Ups! Hubo un error",description:t.error,type:"error"})}},m=async e=>{const o=`${i}/${e.id}`;try{const t=await a.put(o,{json:e,credentials:"include"}).json();s.set(s.get().map(r=>r.id==t.id?t:r)),n.set(n.get().map(r=>r.id==t.id?t:r)),c({title:"Producto actualizado!",description:`${t.name}`,type:"success"})}catch(t){console.log(t);const r=await t.response.json();c({title:"Ups! Hubo un error",description:r.error,type:"error"})}},y=async e=>{const o=`${i}/${e}`;try{const t=await a.delete(o,{credentials:"include"}).json();s.set(s.get().filter(r=>r.id!=t.id)),n.set(n.get().filter(r=>r.id!=t.id)),c({title:"Producto eliminado!",description:`${t.name}`,type:"success"})}catch(t){console.log(t);const r=await t.response.json();c({title:"Ups! Hubo un error",description:r.error,type:"error"})}},w={addProduct:u,removeProduct:y,updateProduct:m,getProducts:p};export{w as P,s as a,n as p};
